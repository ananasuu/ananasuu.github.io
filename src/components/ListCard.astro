---
import { getLocaleFromUrl, getLocalizedContent } from '../utils/i18n/i18n';

const { title } = Astro.props;
const locale = getLocaleFromUrl(Astro.url.pathname);

// Lade die entsprechende JSON-Datei basierend auf dem title
let lists = [];
let isSimpleArray = false;

if (title === 'skills') {
  const rawData = await import('../data/work/skills.json').then(m => m.default);
  lists = rawData.map(item => getLocalizedContent(item, locale));
} else if (title === 'certificates') {
  const rawData = await import('../data/work/certificates.json').then(m => m.default);
  lists = rawData.map(item => getLocalizedContent(item, locale));
} else if (title === 'interests') {
  const data = await import('../data/work/interests.json').then(m => m.default);
  isSimpleArray = true;
  // Interests hat ein anderes Format: { en: "...", de: "..." }
  const localizedItems = data.map(item => locale === 'de' ? item.de : item.en);
  const description = locale === 'de' 
    ? "Irgendwie habe ich es geschafft, so viele Hobbys zu haben, dass ich manchmal von Entscheidungsm√ºdigkeit getroffen werde! Aber ich liebe sie trotzdem"
    : "Somehow I've managed to reach the point of having so many hobbies, that I sometimes get hit with decision fatigue! But I love them nontheless";
  lists = [{ title: locale === 'de' ? 'Interessen' : 'Interests', description, items: localizedItems }];
}
---

{isSimpleArray ? (
  <div class="list-cards">
    {lists.map((list) => (
      <div>
        <h3>{list.title}</h3>
        <p>{list.description}</p>
        <ul>
          {list.items.map((item) => (
            <li>{item}</li>
          ))}
        </ul>
      </div>
    ))}
  </div>
) : (
  <div>
    {lists.map((list) => (
      <div class="infocard">
        <h3>{list.title}</h3>
        {list.description && <p>{list.description}</p>}
        <ul>
          {Array.isArray(list.skills) && list.skills.map((skill: any) => (
            <li>
              {typeof skill === 'string' ? skill : <><span>{skill.skill}</span><span>{skill.experience}</span></>}
            </li>
          ))}
        </ul>
      </div>
    ))}
  </div>
)}