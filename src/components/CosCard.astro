---
import { getLocaleFromUrl, getLocalizedContent } from '../utils/i18n/i18n';

interface Props {
  locale?: 'en' | 'de';
}

const locale = getLocaleFromUrl(Astro.url.pathname) as Props['locale'];
console.log('Pathname:', Astro.url.pathname, 'Locale:', locale);
const cosPortfolio = await import('../data/creative/cosplays.json').then(m => m.default);
---

<ul>
    {cosPortfolio.map((cos) => {
        const localizedCos = getLocalizedContent(cos, locale);
        const avifUrl = localizedCos.imageUrl.replace(/\.(jpg|jpeg|png)$/i, '.avif');
        const isDisabled = !localizedCos.buildbookUrl || localizedCos.buildbookUrl.trim() === '';
        return (
            <li>
                <div class="infocard costume">
                    <h3>{localizedCos.title}</h3>
                    <p class="source">{localizedCos.source}</p>
                    <picture>
                        <source srcset={avifUrl} type="image/avif" />
                        <img src={localizedCos.imageUrl} alt={`${localizedCos.title} from ${localizedCos.source}`} loading="lazy" />
                    </picture>
                    <p class="genres">{localizedCos.genres}</p>
                    <p>{localizedCos.description}</p>
                    <a class="button primary" href={localizedCos.buildbookUrl || ''} aria-disabled={isDisabled ? "true" : "false"}>Build Book</a>
                </div>
            </li>
        );
    })}
</ul>